{
  "families": {
    "governance_task": {
      "lambda_entry": "src/lambdas/governance_task/handler.handler",
      "timeout_seconds": 30,
      "memory_mb": 256
    },
    "idempotency_task": {
      "lambda_entry": "src/lambdas/idempotency_task/handler.handler",
      "timeout_seconds": 15,
      "memory_mb": 256
    },
    "dispatch_task": {
      "lambda_entry": "src/lambdas/dispatch_task/handler.handler",
      "timeout_seconds": 30,
      "memory_mb": 256
    },
    "nova_identity_task": {
      "lambda_entry": "src/lambdas/nova_identity_task/handler.handler",
      "timeout_seconds": 60,
      "memory_mb": 256
    },
    "spectra_discovery_task": {
      "lambda_entry": "src/lambdas/spectra_discovery_task/handler.handler",
      "timeout_seconds": 60,
      "memory_mb": 512
    },
    "spectra_av_task": {
      "lambda_entry": "src/lambdas/spectra_av_task/handler.handler",
      "timeout_seconds": 900,
      "memory_mb": 512
    }
  },

  "workflows": {
    "initialize_nova": {
      "boundary_input_model": "InitializeNovaEvent",
      "states": {
        "BeginJobRun": { "family": "governance_task", "op": "begin_jobrun" },
        "AcquireIdempotencyLock": { "family": "idempotency_task", "op": "acquire_lock" },
        "NormalizeCandidateName": { "family": "nova_identity_task", "op": "normalize_name" },
        "CheckExistingNovaByName": { "family": "nova_identity_task", "op": "check_by_name" },
        "ResolveCandidateAgainstPublicArchives": { "family": "nova_identity_task", "op": "resolve_public_archives", "epic5_stub": true },
        "CheckExistingNovaByCoordinates": { "family": "nova_identity_task", "op": "check_by_coordinates", "epic5_stub": true },
        "UpsertAliasForExistingNova": { "family": "nova_identity_task", "op": "upsert_alias" },
        "CreateNovaId": { "family": "nova_identity_task", "op": "create_nova_id" },
        "UpsertMinimalNovaMetadata": { "family": "nova_identity_task", "op": "upsert_minimal_metadata" },
        "PublishIngestNewNova": {
          "family": "dispatch_task",
          "op": "publish_event",
          "boundary_output_model": "IngestNewNovaEvent"
        },
        "QuarantineHandler": { "family": "governance_task", "op": "quarantine_notify" },
        "FinalizeJobRunSuccess": { "family": "governance_task", "op": "finalize_success" },
        "FinalizeJobRunQuarantined": { "family": "governance_task", "op": "finalize_quarantined" },
        "FinalizeJobRunFailed": { "family": "governance_task", "op": "finalize_failed" },
        "TerminalFailHandler": { "family": "governance_task", "op": "terminal_fail" }
      }
    },

    "ingest_new_nova": {
      "boundary_input_model": "IngestNewNovaEvent",
      "states": {
        "BeginJobRun": { "family": "governance_task", "op": "begin_jobrun" },
        "AcquireIdempotencyLock": { "family": "idempotency_task", "op": "acquire_lock" },
        "LaunchRefreshReferences": {
          "family": "dispatch_task",
          "op": "publish_event",
          "boundary_output_model": "RefreshReferencesEvent",
          "epic5_stub": true
        },
        "LaunchDiscoverSpectraProducts": {
          "family": "dispatch_task",
          "op": "publish_event",
          "boundary_output_model": "DiscoverSpectraProductsEvent"
        },
        "SummarizeLaunch": { "family": "dispatch_task", "op": "summarize_launch" },
        "FinalizeJobRunSuccess": { "family": "governance_task", "op": "finalize_success" },
        "FinalizeJobRunFailed": { "family": "governance_task", "op": "finalize_failed" },
        "TerminalFailHandler": { "family": "governance_task", "op": "terminal_fail" }
      }
    },

    "discover_spectra_products": {
      "boundary_input_model": "DiscoverSpectraProductsEvent",
      "states": {
        "BeginJobRun": { "family": "governance_task", "op": "begin_jobrun" },
        "AcquireIdempotencyLock": { "family": "idempotency_task", "op": "acquire_lock" },

        "QueryProviderForProducts": { "family": "spectra_discovery_task", "op": "query_provider", "epic5_stub": true },
        "NormalizeProviderProducts": { "family": "spectra_discovery_task", "op": "normalize_products" },
        "DeduplicateAndAssignDataProductIds": { "family": "spectra_discovery_task", "op": "assign_data_product_ids" },
        "PersistDataProductMetadata": { "family": "spectra_discovery_task", "op": "persist_metadata" },
        "PublishAcquireAndValidateSpectraRequests": {
          "family": "spectra_discovery_task",
          "op": "publish_acquire_requests",
          "boundary_output_model": "AcquireAndValidateSpectraEvent"
        },

        "SummarizeDiscovery": { "family": "spectra_discovery_task", "op": "summarize_discovery" },
        "FinalizeJobRunSuccess": { "family": "governance_task", "op": "finalize_success" },
        "FinalizeJobRunFailed": { "family": "governance_task", "op": "finalize_failed" },
        "TerminalFailHandler": { "family": "governance_task", "op": "terminal_fail" }
      }
    },

    "acquire_and_validate_spectra": {
      "boundary_input_model": "AcquireAndValidateSpectraEvent",
      "states": {
        "BeginJobRun": { "family": "governance_task", "op": "begin_jobrun" },
        "AcquireIdempotencyLock": { "family": "idempotency_task", "op": "acquire_lock" },

        "LoadDataProductMetadata": { "family": "spectra_av_task", "op": "load_metadata" },
        "CheckOperationalStatus": { "family": "spectra_av_task", "op": "check_status" },
        "AcquireArtifact": { "family": "spectra_av_task", "op": "acquire_artifact", "epic5_stub": true },
        "ValidateBytes": { "family": "spectra_av_task", "op": "validate_profile", "epic5_stub": true },
        "RecordDuplicateLinkage": { "family": "spectra_av_task", "op": "record_duplicate_linkage", "epic5_stub": true },
        "RecordValidationResult": { "family": "spectra_av_task", "op": "record_validation_result" },

        "QuarantineHandler": { "family": "governance_task", "op": "quarantine_notify" },
        "FinalizeJobRunSuccess": { "family": "governance_task", "op": "finalize_success" },
        "FinalizeJobRunQuarantined": { "family": "governance_task", "op": "finalize_quarantined" },
        "FinalizeJobRunFailed": { "family": "governance_task", "op": "finalize_failed" },
        "TerminalFailHandler": { "family": "governance_task", "op": "terminal_fail" }
      }
    }
  }
}
